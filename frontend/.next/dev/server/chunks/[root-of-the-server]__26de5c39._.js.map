{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/a2126/personalProjects/slide-ai/frontend/app/api/narrate/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { Anthropic } from \"@anthropic-ai/sdk\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n  console.log(\"\\n=== /api/narrate CALLED ===\");\r\n\r\n  try {\r\n    const body = await req.json();\r\n    console.log(\"Input body:\", body);\r\n\r\n    if (!body || !body.text) {\r\n      console.log(\"Missing text in request\");\r\n      return NextResponse.json({ success: false, error: \"No text provided\" });\r\n    }\r\n\r\n    console.log(\"Calling Claude…\");\r\n\r\n    const client = new Anthropic({\r\n      apiKey: process.env.ANTHROPIC_API_KEY!,\r\n    });\r\n\r\n    const msg = await client.messages.create({\r\n      model: \"claude-sonnet-4-5\",\r\n      max_tokens: 300,\r\n      messages: [\r\n        {\r\n          role: \"user\",\r\n          content: `Explain this slide in 3–5 sentences:\\n\\n${body.text}`\r\n        }\r\n      ]\r\n    });\r\n\r\n    console.log(\"Claude raw output:\", JSON.stringify(msg, null, 2));\r\n\r\n    // Try to extract first text block\r\n    let narration = \"\";\r\n    if (msg?.content?.length > 0) {\r\n      const block = msg.content.find((b: any) => b.type === \"text\");\r\n      if (block && block.type === \"text\" && \"text\" in block) narration = block.text;\r\n    }\r\n\r\n    console.log(\"Final narration:\", narration);\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      narration,\r\n      debug: {\r\n        raw: msg,\r\n      }\r\n    });\r\n  } catch (err: any) {\r\n    console.log(\"ERROR in /api/narrate:\", err);\r\n    return NextResponse.json({\r\n      success: false,\r\n      error: err.message || \"Server error\"\r\n    });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAEO,eAAe,KAAK,GAAgB;IACzC,QAAQ,GAAG,CAAC;IAEZ,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,QAAQ,GAAG,CAAC,eAAe;QAE3B,IAAI,CAAC,QAAQ,CAAC,KAAK,IAAI,EAAE;YACvB,QAAQ,GAAG,CAAC;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,OAAO;YAAmB;QACvE;QAEA,QAAQ,GAAG,CAAC;QAEZ,MAAM,SAAS,IAAI,kKAAS,CAAC;YAC3B,QAAQ,QAAQ,GAAG,CAAC,iBAAiB;QACvC;QAEA,MAAM,MAAM,MAAM,OAAO,QAAQ,CAAC,MAAM,CAAC;YACvC,OAAO;YACP,YAAY;YACZ,UAAU;gBACR;oBACE,MAAM;oBACN,SAAS,CAAC,wCAAwC,EAAE,KAAK,IAAI,EAAE;gBACjE;aACD;QACH;QAEA,QAAQ,GAAG,CAAC,sBAAsB,KAAK,SAAS,CAAC,KAAK,MAAM;QAE5D,kCAAkC;QAClC,IAAI,YAAY;QAChB,IAAI,KAAK,SAAS,SAAS,GAAG;YAC5B,MAAM,QAAQ,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC,IAAW,EAAE,IAAI,KAAK;YACtD,IAAI,SAAS,MAAM,IAAI,KAAK,UAAU,UAAU,OAAO,YAAY,MAAM,IAAI;QAC/E;QAEA,QAAQ,GAAG,CAAC,oBAAoB;QAEhC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT;YACA,OAAO;gBACL,KAAK;YACP;QACF;IACF,EAAE,OAAO,KAAU;QACjB,QAAQ,GAAG,CAAC,0BAA0B;QACtC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO,IAAI,OAAO,IAAI;QACxB;IACF;AACF"}}]
}